<%-include("./partials/header")-%>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=a98a8e84860d087b0befdbe0ef46f489"></script>

  

	<div class="row">
		<div class="col-md-7 ml-2">
			<table class="table table-hover">
			<thead>
				<tr>
					<th scope="col">no.</th>
					<th scope="col"><i class="far fa-calendar-alt"></i> 등록일</th>
					<th scope="col">스터디</th>
					<th scope="col">유형</th>
					<th scope="col"><i class="fas fa-map-marker-alt"></i> 위치</th>
				</tr>
			</thead>
			<tbody>
			<% studys.forEach((study) => { %>
				<tr>
					<th scope="row">1</th>
					<td><div class="text-muted"><%= moment(study.makedDate).format("YY.MM.DD.") %></div></td>
					<td><a class="text-decoration-none" href ="/study/<%= study._id %>"> <%=study.studyName%> </a></td>
					<td>
						<div class="" style="font-size:small"> 
							<% study.categories.forEach((category) => { %>
								<% if (category==="사기업") { %>
									<a href="#" class="badge badge-danger">사기업</a>
								<% } else if (category === "공기업"){ %>
									<a href="#" class="badge badge-primary">공기업</a>
								<% } else if (category === "인적성"){ %>
									<a href="#" class="badge badge-info">인적성</a> 
								<% } else if (category === "면접") { %>
									<a href="#" class="badge badge-info">면접</a>
								<% } else if (category === "자소서"){ %>
									<a href="#" class="badge badge-info">자소서</a> 
								<% } %>
							<% }) %>
						</div>
					</td>
					<td><div class="text-muted"><%=study.studyAddress%> </div></td>
				</tr>
			<% }) %>
				</tbody>
			</table>		

			<div class="row justify-content-center">
				<nav aria-label="Page navigation example">
					<ul class="pagination">
						<li class="page-item">
							<a class="page-link" href="#" aria-label="Previous">
								<span aria-hidden="true">&laquo;</span>
								<span class="sr-only">Previous</span>
							</a>
						</li>
						<li class="page-item"><a class="page-link" href="#">1</a></li>
						<li class="page-item"><a class="page-link" href="#">2</a></li>
						<li class="page-item"><a class="page-link" href="#">3</a></li>
						<li class="page-item">
							<a class="page-link" href="#" aria-label="Next">
								<span aria-hidden="true">&raquo;</span>
								<span class="sr-only">Next</span>
							</a>
						</li>
					</ul>
				</nav>
			</div>

		</div>		

	<!--지도-->
	<div class="col sticky-top">
		<div id="map" style="width:100%;height:500px;"></div>
	</div>
		
</div> <!-- container-->
	
	

<script>
var mapContainer = document.getElementById('map'); 
mapOption = { 
    center: new daum.maps.LatLng(37.6512265449085, 127.076692983486), 
    level: 9 
};
var map = new daum.maps.Map(mapContainer, mapOption); 

window.onload = function() {  
    fetch("/study/allGetlatlng", {
        method:"post",
    })
    .then((res)=> { return res.json() })
    .then((latlngs) => { 
		console.log(latlngs);		  // [ [{},{},{}] ...]
        latlngs.forEach((latlng) => {
			setMarker(latlng)
		})
    })
}
function setMarker(latlng) {
  var markerPosition  = new daum.maps.LatLng(latlng.lat, latlng.lng); 
  var marker = new daum.maps.Marker({
    position: markerPosition
  });
    marker.setMap(map);
}

</script>

<%-include("./partials/footer")-%>
